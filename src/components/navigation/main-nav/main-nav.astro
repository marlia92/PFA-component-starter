---
import SmartImage from "@components/elements/smart-image/smart-image.astro";
import Bar from "@components/navigation/bar/bar.astro";
import Mobile from "@components/navigation/mobile/mobile.astro";
import ButtonGroup from "@components/wrappers/button-group/button-group.astro";
import Container from "@components/wrappers/container/container.astro";

const {
  logoSource,
  logoAlt = "logo",
  navData = [],
  buttonBlocks = [],
  class: className,
} = Astro.props;

const mobileNavData = [
  ...navData,
  ...buttonBlocks.map((button: any) => ({
    name: button.text || "Button",
    path: button.href || "#",
    children: [],
  })),
];
---

<Container
  maxContentWidth="2xl"
  paddingHorizontal="md"
  paddingVertical="none"
  class:list={["main-nav", className]}
>
  {logoSource && <SmartImage source={logoSource} alt={logoAlt} />}
  <Bar navData={navData} class="desktop-main-nav" />
  <ButtonGroup
    direction="row"
    align="center"
    class="desktop-button-group"
    buttonBlocks={buttonBlocks}
  />
  <Mobile
    logoSource={logoSource}
    logoAlt={logoAlt}
    navData={mobileNavData}
    class="mobile-main-nav"
  />
</Container>

<style>
  :global(.desktop-main-nav.bar),
  :global(.desktop-button-group.button-group) {
    @container (max-width: 768px) {
      display: none;
    }
  }

  :global(.main-nav .nav-hamburger.mobile-button) {
    @container (min-width: 769px) {
      display: none;
    }
  }

  :global(.main-nav .smart-image img) {
    max-height: 3em;
    max-width: min(20em, 100%);
    width: auto;
  }

  :global(.main-nav > .outer-content > .content) {
    align-items: center;
    container-type: inline-size;
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-md);
    justify-content: space-between;
  }
</style>
