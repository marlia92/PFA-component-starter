---
const { contentSections = [] } = Astro.props;
import { getCollection } from "astro:content";

// Load festivals collection once, only needed for festival-list
const festivals = await getCollection('festivals');
---

{contentSections.map(async (section) => {
  if (!section._component) return null;

  // Dynamically import the component
  const Component = (await import(`../${section._component}.astro`)).default;

  // Provide festivals collection to festival-list component
  if (section._component === 'page-sections/festival-list') {
    return <Component festivals={festivals} {...section} />;
  }

  // All other components just get their section props
  return <Component {...section} />;
})}
